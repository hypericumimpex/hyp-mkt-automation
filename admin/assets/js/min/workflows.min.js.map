{"version":3,"sources":["workflows.js"],"names":["$","data","AW","Workflow","Backbone","Model","extend","getAction","action_name","actions","workflow","get","WorkflowView","View","el","$triggerSelect","$triggerDescription","initialize","this","listenTo","model","changeTrigger","set","val","insertMetaboxHelpTips","rules","resetAvailableRules","document","body","trigger","initTooltips","Validate","validateAllFields","AutomateWoo","Workflows","trigger_compatibility_warning","workflowView","completeTriggerChange","clearIncompatibleRules","clearIncompatibleActions","Modal","close","refine_variables","refine_action_selects","maybe_disable_queueing","updateTriggerDescription","cancelTriggerChange","description","html","initAction","$action","attr","group","can_be_previewed","find","each","i","initDynamicActionSelect","$field","reference_field_name","$reference_field","change","updateDynamicActionSelect","is","remove","$fieldRow","parents","addClass","action","target_field_name","reference_field_value","post","ajaxurl","response","removeClass","success","value","text","append","tips","_","tip_html","id","$metabox","TriggerCompatibilityModalView","className","template","wp","$el","on","render","init","jQuery","automatewooWorkflowLocalizeScript","$triggers_box","$actions_box","$actions_container","$action_template","$trigger_select","first","init_triggers_box","init_actions_box","init_options_box","fill_trigger_fields","action_edit_open","click","e","preventDefault","add_new_action","action_edit_close","action_delete","fill_action_fields","preview_action","$checkbox_click_tracking","maybe_hide_tracking_options","show","hide","trigger_name","ajax","method","url","workflow_id","is_new_workflow","done","fields","$new_action","action_number","get_number_of_actions","clone","slideDown","cookie","slideUp","removeCookie","selected_action","$select","title","length","inArray","supplied_data_items","is_action_compatible_with_current_trigger","removeAttr","allow_queueing","incompatibleRules","incompatibleActions","ruleGroup","rule","isRuleAvailable","ruleObject","push","uniq","modalView","open","contents","compatible","required_data_items","name_selector","action_fields","isEmailPreviewOpen","tinyMCE","triggerSave","name","replace","checked","openLoadingEmailPreview","open_email_preview","complete","init_ajax_wysiwyg","tinymce","tinyMCEPreInit","mceInit","automatewoo_editor","qtInit","qtags","selector","wp_autoresize_on","hasClass","hasOwnProperty","quicktags","init_wysiwyg_buttons","canvas","settings","theButtons","use","buttons","edButtons","indexOf","instance","inst","fullscreen","qt","FullscreenButton","getElementsByTagName","dir","textdirection","TextDirectionButton","toolbar","innerHTML"],"mappings":"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","file":"workflows.min.js","sourcesContent":["/**\n * AutomateWoo Workflows Admin\n */\n\n(function( $, data ) {\n\n\tAW.Workflow = Backbone.Model.extend({\n\n\t\tgetAction: function( action_name ) {\n\t\t\tvar actions = AW.workflow.get('actions');\n\n\t\t\tif ( actions[action_name] ) {\n\t\t\t\treturn actions[action_name];\n\t\t\t}\n\t\t}\n\n\t});\n\n\n\tAW.WorkflowView = Backbone.View.extend({\n\n\t\tel: $( 'form#post' ),\n\n\t\t$triggerSelect: $('.js-trigger-select'),\n\n\t\t$triggerDescription: $('.js-trigger-description'),\n\n\n\t\tinitialize: function() {\n\n\t\t\tthis.listenTo( this.model, 'change:trigger', this.changeTrigger );\n\n\t\t\tthis.model.set( 'prevTrigger', this.$triggerSelect.val() );\n\n\t\t\tthis.insertMetaboxHelpTips();\n\t\t},\n\n\n\t\tchangeTrigger: function() {\n\n\t\t\tAW.rules.resetAvailableRules();\n\n            $(document.body).trigger('wc-enhanced-select-init');\n\t\t\tAW.initTooltips();\n\t\t\tAW.Validate.validateAllFields();\n\n\t\t\tif ( AutomateWoo.Workflows.trigger_compatibility_warning() ){\n\t\t\t\tAW.workflowView.completeTriggerChange();\n\t\t\t}\n\t\t},\n\n\n\t\tcompleteTriggerChange: function() {\n\n\t\t\tAW.rules.clearIncompatibleRules();\n\t\t\tAutomateWoo.Workflows.clearIncompatibleActions();\n\n\t\t\tAutomateWoo.Modal.close();\n\n\t\t\tAutomateWoo.Workflows.refine_variables();\n\t\t\tAutomateWoo.Workflows.refine_action_selects();\n\t\t\tAutomateWoo.Workflows.maybe_disable_queueing();\n\n\t\t\tthis.updateTriggerDescription();\n\n\t\t\t// update the prev trigger value\n\t\t\tthis.model.set( 'prevTrigger', this.$triggerSelect.val() );\n\t\t},\n\n\n\t\tcancelTriggerChange: function() {\n\t\t\tthis.$triggerSelect.val( this.model.get('prevTrigger') ).trigger('change');\n\t\t},\n\n\n\t\t/**\n\t\t * Update the trigger description\n\t\t */\n\t\tupdateTriggerDescription: function() {\n\t\t\tvar trigger = this.model.get('trigger');\n\n\t\t\tif ( trigger && trigger.description ) {\n\t\t\t\tthis.$triggerDescription.html( '<p class=\"aw-field-description\">' + trigger.description + '</p>' );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.$triggerDescription.html('');\n\t\t\t}\n\t\t},\n\n\n\n\t\tinitAction: function( action_name, $action ) {\n\n\t\t\tvar data = this.model.getAction( action_name );\n\n\t\t\tif ( data ) {\n\t\t\t\t$action.attr( 'data-automatewoo-action-name', action_name );\n\t\t\t\t$action.attr( 'data-automatewoo-action-group', data.group );\n\t\t\t\t$action.attr( 'data-automatewoo-action-can-be-previewed', data.can_be_previewed );\n\t\t\t}\n\n\t\t\t// update dynamic fields\n\t\t\t$action.find( '[data-automatewoo-dynamic-select]' ).each(function( i, el ){\n\t\t\t\tAW.workflowView.initDynamicActionSelect( $(el), $action );\n\t\t\t});\n\n\t\t\tAW.initTooltips();\n\n\t\t},\n\n\n\t\tinitDynamicActionSelect: function( $field, $action ) {\n\n\t\t\tvar reference_field_name = $field.attr( 'data-automatewoo-dynamic-select-reference' );\n\t\t\tvar $reference_field = $action.find( '.automatewoo-field[data-name=\"' + reference_field_name + '\"]' );\n\n\t\t\t$reference_field.change(function() {\n\t\t\t\tAW.workflowView.updateDynamicActionSelect( $field, $reference_field, $action )\n\t\t\t});\n\t\t},\n\n\n\t\tupdateDynamicActionSelect: function( $field, $reference_field, $action ) {\n\n\t\t\tif ( $field.is( '.automatewoo-field--loading' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// remove existing options\n\t\t\t$field.find( \"option[value!='']\" ).remove();\n\n\t\t\tif ( ! $reference_field.val() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar $fieldRow = $field.parents( '.automatewoo-table__row' );\n\t\t\t$fieldRow.addClass( 'automatewoo-field-row--loading' );\n\n\t\t\tvar data = {\n\t\t\t\taction: 'aw_update_dynamic_action_select',\n\t\t\t\taction_name: $action.data( 'automatewoo-action-name' ),\n\t\t\t\ttarget_field_name: $field.attr( 'data-name' ),\n\t\t\t\treference_field_value: $reference_field.val()\n\t\t\t};\n\n\t\t\t$.post( ajaxurl, data, function( response ) {\n\t\t\t\t$fieldRow.removeClass( 'automatewoo-field-row--loading' );\n\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t$.each( response.data, function ( value, text ) {\n\t\t\t\t\t\t$field.append( $('<option/>', {\n\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\ttext: text\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Add helplinks to top of meta box\n\t\t */\n\t\tinsertMetaboxHelpTips: function() {\n\t\t\tvar tips = this.model.get('metaBoxHelpTips');\n\n\t\t\t_.each( tips, function( tip_html, id ) {\n\t\t\t\t$metabox = $( '#aw_' + id );\n\t\t\t\t$metabox.find('h2.hndle').append(tip_html);\n\t\t\t});\n\t\t}\n\n\n\t});\n\n\n\n\tAW.TriggerCompatibilityModalView = Backbone.View.extend({\n\n\t\tclassName: 'aw-view-trigger-compatibility-modal',\n\n\t\ttemplate: wp.template('aw-trigger-compatibility-modal'),\n\n\t\tdata: null,\n\n\t\tinitialize: function( data ) {\n\t\t\tthis.data = data;\n\n\t\t\tthis.$el.on('click', '.js-confirm', function(){\n\t\t\t\tAW.workflowView.completeTriggerChange()\n\t\t\t});\n\n\t\t\tthis.$el.on('click', '.js-close-automatewoo-modal', function(){\n\t\t\t\tAW.workflowView.cancelTriggerChange()\n\t\t\t});\n\t\t},\n\n\t\trender: function() {\n\t\t\tthis.$el.html( this.template( this.data ));\n\t\t\treturn this;\n\t\t}\n\n\t});\n\n\n\tAW.workflow = new AW.Workflow( data );\n\n\tAW.workflowView = new AW.WorkflowView({\n\t\tmodel: AW.workflow\n\t});\n\n\tAW.Validate.init();\n\n\n})( jQuery, automatewooWorkflowLocalizeScript );\n\n\n\n\n// Remove sortable so it doesn't break wp-editors\njQuery('.meta-box-sortables').removeClass('meta-box-sortables');\n\n\njQuery(function($) {\n\n\n\tAutomateWoo.Workflows = {\n\n\t\t$triggers_box: $('#aw_trigger_box'),\n\n\t\t$actions_box: $('#aw_actions_box'),\n\n\t\t$actions_container: $('.aw-actions-container'),\n\n\t\t$action_template: $('.aw-action-template'),\n\n\t\t$trigger_select: $('.js-trigger-select').first(),\n\n\n\t\tinit: function() {\n\t\t\tAutomateWoo.Workflows.init_triggers_box();\n\t\t\tAutomateWoo.Workflows.init_actions_box();\n\t\t\tAutomateWoo.Workflows.init_options_box();\n\t\t},\n\n\n\n\t\t/**\n\t\t *\n\t\t */\n\t\tinit_triggers_box: function() {\n\t\t\tAutomateWoo.Workflows.$trigger_select.change(function(){\n\t\t\t\tAutomateWoo.Workflows.fill_trigger_fields( $(this).val() );\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t *\n\t\t */\n\t\tinit_actions_box: function() {\n\n\n\t\t\t$('.automatewoo-action.js-open').each(function(){\n\t\t\t\tAutomateWoo.Workflows.action_edit_open( $(this) );\n\t\t\t});\n\n\n\t\t\t$('.js-aw-add-action').click(function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tAutomateWoo.Workflows.add_new_action();\n\t\t\t});\n\n\t\t\t$(document).on('click', '.js-edit-action', function (e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar $action = $(this).parents('.automatewoo-action').first();\n\n\t\t\t\tif ($action.is('.js-open')) {\n\t\t\t\t\tAutomateWoo.Workflows.action_edit_close($action);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tAutomateWoo.Workflows.action_edit_open($action);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(document).on('click', '.js-delete-action', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tvar $action = $(this).parents('.automatewoo-action').first();\n\t\t\t\tAutomateWoo.Workflows.action_delete($action);\n\t\t\t});\n\n\t\t\t// Action select change\n\t\t\t$(document).on('change', '.js-action-select', function () {\n\t\t\t\tvar $action = $(this).parents('.automatewoo-action').first();\n\t\t\t\tAutomateWoo.Workflows.fill_action_fields( $action, $(this).val() );\n\t\t\t});\n\n\t\t\t// preview links\n\t\t\t$(document).on('click', '[data-automatewoo-preview]', function(e){\n\t\t\t\te.preventDefault();\n\t\t\t\tvar $action = $(this).parents('.automatewoo-action').first();\n\t\t\t\tAutomateWoo.Workflows.preview_action($action);\n\t\t\t});\n\n\n\t\t\tif ( ! AW.workflow.get('isNew') ) {\n\t\t\t\tAutomateWoo.Workflows.refine_action_selects();\n\t\t\t\tAutomateWoo.Workflows.refine_variables();\n\t\t\t\tAutomateWoo.Workflows.maybe_disable_queueing();\n\n\t\t\t\t$('.automatewoo-action').each(function( i, el ) {\n\t\t\t\t\tAW.workflowView.initAction( $(el).find('.js-action-select').val(), $(el) );\n\t\t\t\t});\n\n\t\t\t}\n\t\t},\n\n\n\n\t\tinit_options_box: function() {\n\n\t\t\tvar $checkbox_click_tracking = $('.aw-checkbox-enable-click-tracking');\n\n\t\t\tAutomateWoo.Workflows.maybe_hide_tracking_options();\n\n\t\t\t$checkbox_click_tracking.click(function(){\n\t\t\t\tAutomateWoo.Workflows.maybe_hide_tracking_options();\n\t\t\t});\n\n\t\t},\n\n\n\n\t\tmaybe_hide_tracking_options: function() {\n\n\t\t\tvar $checkbox_click_tracking = $('.aw-checkbox-enable-click-tracking');\n\t\t\tvar checked = $checkbox_click_tracking.is(':checked');\n\n\t\t\tif ( ! checked ) {\n\t\t\t\t$('.js-require-email-tracking').hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('.js-require-email-tracking').show();\n\t\t\t}\n\t\t},\n\n\n\n\t\t/**\n\t\t * @param trigger_name\n\t\t */\n\t\tfill_trigger_fields: function( trigger_name ) {\n\n\t\t\t// Remove existing fields\n\t\t\tAutomateWoo.Workflows.$triggers_box.find('tr.aw-trigger-option').remove();\n\n\t\t\tif ( trigger_name ) {\n\n\t\t\t\tAutomateWoo.Workflows.$triggers_box.addClass('aw-loading');\n\n\t\t\t\t$.ajax({\n\t\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\t\turl: ajaxurl,\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\taction: 'aw_fill_trigger_fields',\n\t\t\t\t\t\t\ttrigger_name: trigger_name,\n\t\t\t\t\t\t\tworkflow_id: AW.workflow.get('id'),\n\t\t\t\t\t\t\tis_new_workflow: AW.workflow.get('isNew')\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.done(function(response){\n\n\t\t\t\t\t\tif ( ! response.success ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tAutomateWoo.Workflows.$triggers_box.find('tbody').append( response.data.fields );\n\t\t\t\t\t\tAutomateWoo.Workflows.$triggers_box.removeClass('aw-loading');\n\n\t\t\t\t\t\tAW.workflow.set( 'trigger', response.data.trigger );\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t}\n\t\t\telse {\n\t\t\t\tAW.workflow.set( 'trigger', false );\n\t\t\t}\n\t\t},\n\n\n\n\t\tadd_new_action: function() {\n\n\t\t\tvar $new_action,\n\t\t\t\taction_number = AutomateWoo.Workflows.get_number_of_actions() + 1;\n\n\t\t\t$('.js-aw-no-actions-message').hide();\n\n\t\t\t$new_action = AutomateWoo.Workflows.$action_template.clone();\n\t\t\t$new_action.removeClass('aw-action-template');\n\t\t\t$new_action.addClass('automatewoo-action');\n\n\t\t\tAutomateWoo.Workflows.$actions_container.append($new_action);\n\n\t\t\t$new_action.attr( 'data-action-number', action_number );\n\n\t\t\tAutomateWoo.Workflows.action_edit_open($new_action);\n\t\t},\n\n\n\n\t\taction_edit_open: function( $action ) {\n\n\t\t\tvar action_number = $action.data('action-number');\n\n\t\t\t$action.addClass('js-open');\n\t\t\t$action.find('.automatewoo-action__fields').slideDown(150);\n\n\t\t\tAW.initTooltips();\n\n\t\t\t// save open state\n\t\t\t$.cookie( 'aw_editing_action_' + AW.workflow.get('id') + '_' + action_number , 1);\n\t\t},\n\n\n\t\taction_edit_close: function( $action ) {\n\n\t\t\tvar action_number = $action.data('action-number');\n\n\t\t\t$action.removeClass('js-open');\n\t\t\t$action.find('.automatewoo-action__fields').slideUp(150);\n\n\t\t\t$.removeCookie( 'aw_editing_action_' + AW.workflow.get('id') + '_' + action_number );\n\t\t},\n\n\n\t\t/**\n\t\t * @param $action\n\t\t */\n\t\taction_delete: function( $action ) {\n\t\t\t$action.remove();\n\t\t},\n\n\n\t\t/**\n\t\t *\n\t\t */\n\t\tfill_action_fields: function( $action, selected_action ) {\n\n\t\t\tvar action_number = $action.data('action-number');\n\t\t\tvar $select = $action.find('.js-action-select');\n\n\t\t\tAutomateWoo.Workflows.$actions_box.addClass('aw-loading');\n\n\t\t\t// Remove existing fields\n\t\t\t$action.find('tr.automatewoo-table__row:not([data-name=\"action_name\"])').remove();\n\n\n\t\t\t$.ajax({\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'aw_fill_action_fields',\n\t\t\t\t\taction_name: selected_action,\n\t\t\t\t\taction_number: action_number,\n\t\t\t\t\tworkflow_id: AW.workflow.get('id')\n\t\t\t\t}\n\t\t\t})\n\t\t\t\t.done(function(response){\n\n\t\t\t\t\t$action.find('.automatewoo-table tbody').append( response.data.fields );\n\t\t\t\t\tAutomateWoo.Workflows.$actions_box.removeClass('aw-loading');\n\n\t\t\t\t\t// Fill select box name\n\t\t\t\t\t$select.attr('name', 'aw_workflow_data[actions]['+action_number+'][action_name]' );\n\n\t\t\t\t\t// Pre fill title\n\t\t\t\t\t$action.find('.action-title').text( response.data.title );\n\n\t\t\t\t\t$action.find('.js-action-description').html( response.data.description );\n\n\t\t\t\t\tAW.workflowView.initAction( selected_action, $action );\n\n\t\t\t\t})\n\t\t\t;\n\n\t\t},\n\n\n\n\t\tget_number_of_actions: function () {\n\t\t\treturn $('.automatewoo-action').length;\n\t\t},\n\n\n\n\t\t/**\n\t\t * Show or hide text var groups based on the selected trigger\n\t\t */\n\t\trefine_variables: function() {\n\n\t\t\tvar trigger = AW.workflow.get('trigger');\n\n\t\t\t$('.aw-variables-group').each(function( i, el ){\n\n\t\t\t\tvar group = $(el).data( 'automatewoo-variable-group' );\n\n\t\t\t\tif ( $.inArray( group, trigger.supplied_data_items ) == -1 ) {\n\t\t\t\t\t$(el).hide();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t$(el).show();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Show or hide select options based on the selected trigger\n\t\t * Also what if a trigger is changed after an action is already added\n\t\t */\n\t\trefine_action_selects: function() {\n\n\t\t\t$('.js-action-select').each(function(){\n\t\t\t\t$(this).find('option').each(function(){\n\n\t\t\t\t\tif ( AutomateWoo.Workflows.is_action_compatible_with_current_trigger( $(this).val() ) ) {\n\t\t\t\t\t\t$(this).removeAttr('disabled');\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t$(this).attr('disabled', true);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t});\n\t\t},\n\n\n\t\t/**\n\t\t * Hide queue if disabled for the selected trigger\n\t\t */\n\t\tmaybe_disable_queueing: function() {\n\t\t\tvar trigger = AW.workflow.get('trigger');\n\n\t\t\tif ( trigger && trigger.allow_queueing ) {\n\t\t\t\t$('#aw_timing_box').show();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$('#aw_timing_box').hide();\n\t\t\t}\n\t\t},\n\n\n\t\t/**\n\t\t * Be sure to run this before refine_action_selects\n\t\t *\n\t\t * Returns false if switching back to stop the trigger change\n\t\t *\n\t\t * @return boolean\n\t\t */\n\t\ttrigger_compatibility_warning: function(){\n\n\t\t\tvar incompatibleRules = [];\n\t\t\tvar incompatibleActions = [];\n\n\t\t\t_.each( AW.rules.get( 'ruleOptions' ), function( ruleGroup ) {\n\t\t\t\t_.each( ruleGroup.get( 'rules' ), function( rule ) {\n\t\t\t\t\tif ( rule.get('name') && ! AW.rules.isRuleAvailable( rule.get('name') ) ) {\n\t\t\t\t\t\tvar ruleObject = rule.get( 'object' );\n\t\t\t\t\t\tincompatibleRules.push( ruleObject.title );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\n\t\t\t$('.js-action-select').each(function(){\n\t\t\t\tif ( ! AutomateWoo.Workflows.is_action_compatible_with_current_trigger( $(this).val() ) ) {\n\t\t\t\t\tincompatibleActions.push( $(this).find('option:selected').text() )\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\tif ( incompatibleRules.length || incompatibleActions.length ) {\n\n\t\t\t\tincompatibleActions = _.uniq( incompatibleActions );\n\t\t\t\tincompatibleRules = _.uniq( incompatibleRules );\n\n\t\t\t\tvar modalView = new AW.TriggerCompatibilityModalView({\n\t\t\t\t\tincompatibleRules: incompatibleRules,\n\t\t\t\t\tincompatibleActions: incompatibleActions\n\t\t\t\t});\n\n\t\t\t\tAutomateWoo.Modal.open();\n\t\t\t\tAutomateWoo.Modal.contents( modalView.render().el );\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\n\n\t\tclearIncompatibleActions: function() {\n\t\t\t$('.js-action-select').each(function(){\n\t\t\t\tif ( ! AutomateWoo.Workflows.is_action_compatible_with_current_trigger( $(this).val() ) ) {\n\t\t\t\t\tvar $action = $(this).parents('.automatewoo-action').first();\n\t\t\t\t\tAutomateWoo.Workflows.action_delete( $action );\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\n\n\t\t/**\n\t\t *\n\t\t * @param action_name\n\t\t *\n\t\t * @return boolean\n\t\t */\n\t\tis_action_compatible_with_current_trigger: function( action_name ) {\n\n\t\t\tvar compatible = true,\n\t\t\t \ttrigger = AW.workflow.get('trigger'),\n\t\t\t\taction = AW.workflow.getAction(action_name);\n\n\t\t\t// Not a valid action\n\t\t\tif ( ! action ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// No data items required\n\t\t\tif ( ! action.required_data_items.length ){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t$.each( action.required_data_items, function(i, value){\n\n\t\t\t\tif ( $.inArray( value, trigger.supplied_data_items ) == -1 ) {\n\t\t\t\t\tcompatible = false\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn compatible;\n\t\t},\n\n\n\n\t\tpreview_action: function( $action ) {\n\n\t\t\tvar action_number = $action.data('action-number');\n\t\t\tvar name_selector;\n\t\t\tvar trigger = AW.workflow.get('trigger');\n\t\t\tvar action_fields = {};\n\n\t\t\tif ( AutomateWoo.isEmailPreviewOpen() ) {\n\t\t\t\tAutomateWoo.Workflows.$actions_box.addClass('aw-loading');\n\t\t\t}\n\n\t\t\tif ( typeof tinyMCE !== 'undefined' ) {\n\t\t\t\ttinyMCE.triggerSave();\n\t\t\t}\n\n\t\t\tname_selector = 'aw_workflow_data[actions]['+action_number+']';\n\n\t\t\t// get fields to preview\n\t\t\t$action.find('[name*=\"' + name_selector + '\"]').each(function( i, el ){\n\n\t\t\t\tvar name, val;\n\n\t\t\t\t// get the name\n\t\t\t\tname = $(el).attr('name').replace(name_selector, '').replace('[', '').replace(']', '');\n\n\t\t\t\tif ( $(el).attr('type') === 'checkbox' ) {\n                    val = el.checked ? '1' : '';\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tval = $(el).val();\n\n\t\t\t\t}\n\t\t\t\taction_fields[name] = val;\n\t\t\t});\n\n\t\t\tAutomateWoo.openLoadingEmailPreview(); // open the preview window before saving so that the popup is not blocked\n\n\t\t\t$.ajax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'aw_save_preview_data',\n\t\t\t\t\tworkflow_id: AW.workflow.get('id'),\n\t\t\t\t\ttrigger_name: trigger ? trigger.name : '',\n\t\t\t\t\taction_fields: action_fields,\n\t\t\t\t},\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tAutomateWoo.open_email_preview( 'workflow_action', {\n\t\t\t\t\t\tworkflow_id: AW.workflow.get('id'),\n\t\t\t\t\t\taction_number: action_number\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcomplete: function() {\n\t\t\t\t\tAutomateWoo.Workflows.$actions_box.removeClass('aw-loading');\n\t\t\t\t}\n\t\t\t});\n\n\t\t},\n\n\n\t\t/**\n\t\t * @param id\n         */\n\t\tinit_ajax_wysiwyg: function( id ){\n\n\t\t\tif ( typeof tinymce === 'undefined' || typeof tinyMCEPreInit.mceInit.automatewoo_editor === 'undefined' )\n\t\t\t\treturn;\n\n\t\t\tvar $wrap,\n\t\t\t\tmceInit,\n\t\t\t\tqtInit,\n\t\t\t\tqtags;\n\n\t\t\tmceInit = $.extend({}, tinyMCEPreInit.mceInit.automatewoo_editor );\n\t\t\tqtInit = $.extend({}, tinyMCEPreInit.qtInit.automatewoo_editor );\n\n\t\t\tmceInit.selector = '#' + id;\n\t\t\tmceInit.id = id;\n\t\t\tmceInit.wp_autoresize_on = false;\n\n\t\t\ttinyMCEPreInit.mceInit[ mceInit.id ] = mceInit;\n\n\n\t\t\tqtInit.id = id;\n\n\t\t\t$wrap = tinymce.$( '#wp-' + id + '-wrap' );\n\n\t\t\tif ( ( $wrap.hasClass( 'tmce-active' ) || ! tinyMCEPreInit.qtInit.hasOwnProperty( id ) ) ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\ttinymce.init( mceInit );\n\n\t\t\t\t} catch(e){}\n\t\t\t}\n\n\t\t\ttry {\n\n\t\t\t\tqtags = quicktags( qtInit );\n\n\t\t\t\tthis.init_wysiwyg_buttons( qtags );\n\n\t\t\t} catch(e){}\n\n\t\t},\n\n\n\t\t/**\n\t\t *\n\t\t * @param qtags\n         */\n\t\tinit_wysiwyg_buttons: function( qtags ) {\n\n\t\t\tvar defaults = ',strong,em,link,block,del,ins,img,ul,ol,li,code,more,close,';\n\n\t\t\tcanvas = qtags.canvas;\n\t\t\tname = qtags.name;\n\t\t\tsettings = qtags.settings;\n\t\t\thtml = '';\n\t\t\ttheButtons = {};\n\t\t\tuse = '';\n\n\t\t\t// set buttons\n\t\t\tif ( settings.buttons ) {\n\t\t\t\tuse = ','+settings.buttons+',';\n\t\t\t}\n\n\t\t\tfor ( i in edButtons ) {\n\t\t\t\tif ( !edButtons[i] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tid = edButtons[i].id;\n\t\t\t\tif ( use && defaults.indexOf( ',' + id + ',' ) !== -1 && use.indexOf( ',' + id + ',' ) === -1 ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif ( !edButtons[i].instance || edButtons[i].instance === inst ) {\n\t\t\t\t\ttheButtons[id] = edButtons[i];\n\n\t\t\t\t\tif ( edButtons[i].html ) {\n\t\t\t\t\t\thtml += edButtons[i].html(name + '_');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( use && use.indexOf(',fullscreen,') !== -1 ) {\n\t\t\t\ttheButtons.fullscreen = new qt.FullscreenButton();\n\t\t\t\thtml += theButtons.fullscreen.html(name + '_');\n\t\t\t}\n\n\n\t\t\tif ( 'rtl' === document.getElementsByTagName('html')[0].dir ) {\n\t\t\t\ttheButtons.textdirection = new qt.TextDirectionButton();\n\t\t\t\thtml += theButtons.textdirection.html(name + '_');\n\t\t\t}\n\n\t\t\tqtags.toolbar.innerHTML = html;\n\t\t\tqtags.theButtons = theButtons;\n\n\t\t}\n\n\n\t};\n\t\n\n\tAutomateWoo.Workflows.init();\n\n\n});"]}